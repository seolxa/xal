<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="theme-color" content="#d32f2f">
<link rel="manifest" href="manifest.webmanifest">
<link rel="apple-touch-icon" href="apple-touch-icon.png">
<title>ë…ì„œ ì‚¬ì´í´ë§ Â· ë ˆë“œ í…Œë§ˆ</title>
<style>
:root{ --bg:#1a0f10; --fg:#f6ecec; --muted:#d2bcbc; --card:#231416;
--acc:#e53935; --acc2:#ff6b6b; --danger:#ff6b6b; --ok:#7ddc83; --border:#3a2022; }
@media (prefers-color-scheme: light){ :root{ --bg:#fff6f6; --fg:#241617; --muted:#6b4c4f; --card:#ffffff; --acc:#d32f2f; --acc2:#ff6b6b; --danger:#d64045; --ok:#2f9e44; --border:#f0dada; } }
*{box-sizing:border-box} html,body{margin:0;height:100%;background:var(--bg);color:var(--fg);
font-family:system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Noto Sans KR,sans-serif}
.container{max-width:960px;margin:0 auto;padding:18px}
h1{font-weight:800;letter-spacing:-0.2px;font-size:1.6rem;margin:8px 0 14px}
.header{display:flex;flex-wrap:wrap;gap:12px;align-items:center;justify-content:space-between}
.card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:14px}
.row{display:flex;gap:12px;flex-wrap:wrap} .col{flex:1 1 260px} label{font-size:.9rem;color:var(--muted)}
input[type=time]{padding:8px 10px;border-radius:10px;border:1px solid var(--border);background:transparent;color:var(--fg);font-size:1rem}
button{padding:10px 14px;border-radius:12px;border:1px solid var(--border);background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(0,0,0,.04));cursor:pointer;color:var(--fg)}
button.primary{background:linear-gradient(180deg, var(--acc), #bb1d1d); color:white; border:none}
button.ok{background:linear-gradient(180deg, var(--acc2), #bb3b3b); color:white; border:none}
button.ghost{opacity:.9;background:transparent;border:1px dashed var(--border)} button:active{transform:translateY(1px)}
.badge{font-size:.75rem;color:var(--muted)} .list{margin:8px 0 0;padding:0;list-style:none}
.item{display:grid;grid-template-columns:110px 1fr;gap:10px;padding:10px;border-bottom:1px dashed var(--border)}
.item .time{font-variant-numeric:tabular-nums;color:var(--muted)} .kbd{font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;background:rgba(255,255,255,.06);padding:2px 6px;border-radius:8px;border:1px solid var(--border)}
hr{border:none;border-top:1px dashed var(--border);margin:14px 0} .timer{display:flex;align-items:center;gap:12px;margin-top:8px}
.timer .big{font-size:2rem;font-variant-numeric:tabular-nums} .phase{padding:4px 8px;border-radius:999px;border:1px solid var(--border);color:var(--muted)}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px} .small{font-size:.88rem;color:var(--muted)}
footer{opacity:.7;margin-top:12px;font-size:.85rem;color:var(--muted)} .toggle{display:flex;align-items:center;gap:8px}
.switch{position:relative;width:46px;height:26px;background:var(--border);border-radius:16px;cursor:pointer}
.switch:after{content:"";position:absolute;top:3px;left:3px;width:20px;height:20px;border-radius:50%;background:white;transition:.2s}
input[type=checkbox]{display:none} input[type=checkbox]:checked + .switch{background:linear-gradient(90deg,var(--acc2),var(--acc))}
input[type=checkbox]:checked + .switch:after{left:23px} .note{background:rgba(255,255,255,.06);border:1px solid var(--border);padding:8px 10px;border-radius:10px}
.hero{display:block;width:100%;height:auto;border-radius:14px;border:1px solid var(--border)} .caption{font-size:.85rem;color:var(--muted);margin-top:6px}
</style>
</head>
<body>
<div class="container">
  <div class="header">
    <h1>ë…ì„œ ì‚¬ì´í´ë§ Â· <span style="color:var(--acc)">ë ˆë“œ í…Œë§ˆ</span></h1>
    <div class="toggle">
      <label class="small">ë‹¨ê³„ ì•Œë¦¼</label>
      <input id="notif" type="checkbox"><div class="switch" id="notifSwitch"></div>
      <label class="small">ë¹„í”„ìŒ</label>
      <input id="beep" type="checkbox" checked><div class="switch" id="beepSwitch"></div>
    </div>
  </div>

  <div class="card" style="margin-bottom:12px">
    <img src="assets/cat-reading.jpg" alt="ê³ ì–‘ì´ì˜ ì•¼ê°„ ë…ì„œ" class="hero">
    <div class="caption">ì˜¤ëŠ˜ì˜ ë…ì„œ ì½”ì¹˜ ğŸ±: â€œì‚¬ì´í´ í•œ ë°”í€´, ê·¸ë¦¬ê³  ë˜ í•œ ë°”í€´.â€</div>
  </div>

  <div class="row">
    <div class="col card">
      <label>ì‹œì‘ ì‹œê°</label><br>
      <input type="time" id="start" value="14:00">
      <div class="small" id="today"></div>
      <hr>
      <div class="small">íŒ¨í„´: ì˜¨ë¨í”„ 6â€² â†’ (25â€² ì½ê¸° + 5â€² ì¹´ë“œ + 5â€² íœ´ì‹) Ã—3 â†’ ì¸í„°ë¯¸ì…˜ 12â€² â†’ (25/5/5) Ã—2 â†’ (25/5/5) Ã—1 â†’ ì¿¨ë‹¤ìš´ 12â€²</div>
    </div>
    <div class="col card">
      <div class="row">
        <button type="button" class="ghost" id="gen">ì‹œê°„í‘œ ìƒì„±/ê°±ì‹ </button>
        <button type="button" id="export">ì‹œê°„í‘œ ë³µì‚¬</button>
      </div>
      <div class="note small" style="margin-top:10px">ì´ í˜ì´ì§€ëŠ” ë ˆë“œ í…Œë§ˆ & ì˜¤í”„ë¼ì¸(PWA) ì§€ì›ì…ë‹ˆë‹¤.</div>
    </div>
  </div>

  <div class="card" style="margin-top:12px">
    <div class="row" style="justify-content:space-between;align-items:center">
      <div><strong>ì˜¤ëŠ˜ ì‹œê°„í‘œ</strong> <span class="badge">ìë™ ê³„ì‚°</span></div>
      <div class="small">ê° í–‰ì˜ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ <span class="kbd">íƒ€ì´ë¨¸</span>ê°€ ì‹œì‘ë©ë‹ˆë‹¤.</div>
    </div>
    <ul class="list" id="schedule"></ul>
  </div>

  <div class="grid" style="margin-top:12px">
    <div class="card">
      <div><strong>ë¹ ë¥¸ íƒ€ì´ë¨¸</strong> <span class="badge">25â€²/5â€²/5â€² ìë™ ì§„í–‰</span></div>
      <div class="timer">
        <span class="phase" id="phase">ëŒ€ê¸°</span>
        <span class="big" id="clock">00:00</span>
      </div>
      <div class="row" style="margin-top:8px">
        <button type="button" class="primary" id="startCycle">ì‚¬ì´í´ ì‹œì‘</button>
        <button type="button" id="pause">ì¼ì‹œì •ì§€</button>
        <button type="button" id="reset">ë¦¬ì…‹</button>
      </div>
      <div class="row" style="margin-top:8px">
        <button type="button" data-solo="onramp">ì˜¨ë¨í”„ 6â€²</button>
        <button type="button" data-solo="inter">ì¸í„°ë¯¸ì…˜ 12â€²</button>
        <button type="button" data-solo="cool">ì¿¨ë‹¤ìš´ 12â€²</button>
      </div>
      <div class="small" style="margin-top:8px">ì‚¬ì´í´ = ì½ê¸° 25â€² â†’ ì¹´ë“œ 5â€² â†’ íœ´ì‹ 5â€² (ìë™ ì „í™˜)</div>
    </div>
    <div class="card">
      <div><strong>ìƒíƒœ</strong></div>
      <div class="small" id="status">ëŒ€ê¸° ì¤‘â€¦</div>
      <hr>
      <div class="small">ì•Œë¦¼/ë¹„í”„ìŒì€ í˜ì´ì§€ê°€ ì—´ë ¤ ìˆì„ ë•Œë§Œ ì‘ë™í•©ë‹ˆë‹¤.</div>
    </div>
  </div>

  <footer>Â© ë…ì„œ ì‚¬ì´í´ë§ â€” ë ˆë“œ í…Œë§ˆ & ì˜¤í”„ë¼ì¸(PWA)</footer>
</div>

<script>
const $ = s=>document.querySelector(s);
const todayEl=$("#today"), scheduleEl=$("#schedule");
const startInput=$("#start"), genBtn=$("#gen"), exportBtn=$("#export");
const startCycleBtn=$("#startCycle"), pauseBtn=$("#pause"), resetBtn=$("#reset");
const clockEl=$("#clock"), phaseEl=$("#phase"), statusEl=$("#status");
const notifChk=$("#notif"), notifSwitch=$("#notifSwitch");
const beepChk=$("#beep"), beepSwitch=$("#beepSwitch");

let audioCtx=null;
function beep(){
  if(!beepChk.checked) return;
  try{ if(!audioCtx) audioCtx = new (window.AudioContext||window.webkitAudioContext)();
    const o = audioCtx.createOscillator(); const g = audioCtx.createGain();
    o.frequency.value=880; g.gain.setValueAtTime(0.0001, audioCtx.currentTime);
    g.gain.exponentialRampToValueAtTime(0.2, audioCtx.currentTime+0.01);
    g.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime+0.25);
    o.connect(g); g.connect(audioCtx.destination); o.start(); o.stop(audioCtx.currentTime+0.26);
  }catch(e){}
}
function notify(title, body){
  if(!notifChk.checked) return; if(!("Notification" in window)) return;
  if(Notification.permission==="granted") new Notification(title,{body});
  else if(Notification.permission!=="denied") Notification.requestPermission().then(p=>{ if(p==="granted") new Notification(title,{body}); });
}
function fmt(n){return String(n).padStart(2,"0");} function addMin(d,m){const x=new Date(d); x.setMinutes(x.getMinutes()+m); return x;}
function hhmm(d){return fmt(d.getHours())+":"+fmt(d.getMinutes());} function stamp(){ const d=new Date(); return d.toLocaleString(); }

const PLAN=[["ì˜¨ë¨í”„",6],["ì‚¬ì´í´ 1 ì½ê¸°",25],["ì‚¬ì´í´ 1 ì¹´ë“œ",5],["ì‚¬ì´í´ 1 íœ´ì‹",5],
["ì‚¬ì´í´ 2 ì½ê¸°",25],["ì‚¬ì´í´ 2 ì¹´ë“œ",5],["ì‚¬ì´í´ 2 íœ´ì‹",5],["ì‚¬ì´í´ 3 ì½ê¸°",25],["ì‚¬ì´í´ 3 ì¹´ë“œ",5],["ì‚¬ì´í´ 3 íœ´ì‹",5],
["ì¸í„°ë¯¸ì…˜",12],["ì‚¬ì´í´ 4 ì½ê¸°",25],["ì‚¬ì´í´ 4 ì¹´ë“œ",5],["ì‚¬ì´í´ 4 íœ´ì‹",5],["ì‚¬ì´í´ 5 ì½ê¸°",25],["ì‚¬ì´í´ 5 ì¹´ë“œ",5],["ì‚¬ì´í´ 5 íœ´ì‹",5],
["ì‚¬ì´í´ 6 ì½ê¸°(ë§ˆì§€ë§‰)",25],["ì‚¬ì´í´ 6 ì¹´ë“œ",5],["ì‚¬ì´í´ 6 íœ´ì‹",5],["ì¿¨ë‹¤ìš´",12]];

function buildSchedule(){
  const [h,m]=startInput.value.split(":").map(Number);
  const start=new Date(); start.setHours(h,m,0,0);
  todayEl.textContent="ì˜¤ëŠ˜: "+start.toLocaleDateString(undefined,{weekday:"short",month:"short",day:"numeric"})+" Â· ì‹œì‘ "+startInput.value;
  scheduleEl.innerHTML=""; let t=start;
  PLAN.forEach(([label,dur])=>{ const t2=addMin(t,dur);
    const li=document.createElement("li"); li.className="item";
    const btn=document.createElement("button"); btn.type="button"; btn.className="ghost startPart";
    btn.textContent=label; btn.dataset.label=label; btn.dataset.dur=dur;
    const time=document.createElement("div"); time.className="time"; time.textContent=`${hhmm(t)}â€“${hhmm(t2)}`;
    const task=document.createElement("div"); task.appendChild(btn);
    li.appendChild(time); li.appendChild(task); scheduleEl.appendChild(li); t=t2; });
  scheduleEl.querySelectorAll(".startPart").forEach(b=>b.addEventListener("click", ()=>startPart(b.dataset.label, parseInt(b.dataset.dur,10)) ));
  statusEl.textContent="ì‹œê°„í‘œë¥¼ ìƒì„±í–ˆìŠµë‹ˆë‹¤."; localStorage.setItem("reading_cycle_start", startInput.value);
}

let timer=null, endAt=null, queue=[], paused=false, remaining=0;
function setPhase(name, secs){ phaseEl.textContent=name; endAt=Date.now()+secs*1000; remaining=secs*1000; paused=false; if(timer) clearInterval(timer); tick(); timer=setInterval(tick,200); }
function tick(){ if(paused){ clockEl.textContent = msToClock(remaining); return; } const left=endAt-Date.now();
  if(left<=0){ clockEl.textContent="00:00"; beep(); if(queue.length){ const nxt=queue.shift(); notify("ë‹¤ìŒ ë‹¨ê³„",`${nxt.title} ì‹œì‘`); setPhase(nxt.title, nxt.secs); statusEl.textContent=`${stamp()} Â· ${nxt.title} ì‹œì‘`; } else { phaseEl.textContent="ì™„ë£Œ"; statusEl.textContent=`${stamp()} Â· íƒ€ì´ë¨¸ ì™„ë£Œ`; notify("ì™„ë£Œ","ëª¨ë“  ë‹¨ê³„ê°€ ëë‚¬ìŠµë‹ˆë‹¤."); clearInterval(timer); timer=null; } return; }
  clockEl.textContent = msToClock(left);
}
function msToClock(ms){ const s=Math.ceil(ms/1000); const mm=Math.floor(s/60), ss=s%60; return fmt(mm)+":"+fmt(ss); }
function startCycle(){ queue=[{title:"ì½ê¸°",secs:25*60},{title:"ì¹´ë“œ",secs:5*60},{title:"íœ´ì‹",secs:5*60}]; const first=queue.shift(); notify("ì‚¬ì´í´ ì‹œì‘","ì½ê¸° 25ë¶„ ì‹œì‘"); setPhase(first.title, first.secs); statusEl.textContent=`${stamp()} Â· ì‚¬ì´í´(25/5/5) ì‹œì‘`; }
function startPart(label, dur){ queue=[]; setPhase(label, dur*60); notify(label+" ì‹œì‘","íƒ€ì´ë¨¸ê°€ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤."); statusEl.textContent=`${stamp()} Â· ${label} ì‹œì‘`; }

document.addEventListener("DOMContentLoaded", ()=>{ const saved=localStorage.getItem("reading_cycle_start"); if(saved) startInput.value=saved;
  buildSchedule(); clockEl.textContent="00:00";
  document.getElementById("gen").addEventListener("click", buildSchedule); startInput.addEventListener("change", buildSchedule);
  document.getElementById("export").addEventListener("click", ()=>{ let text="ë…ì„œ ì‚¬ì´í´ë§ ì‹œê°„í‘œ ("+startInput.value+" ì‹œì‘)\n"; document.querySelectorAll(".item").forEach(r=>{ const time=r.querySelector(".time").textContent; const task=r.querySelector(".startPart").textContent.trim(); text += `- ${time}  ${task}\n`; }); navigator.clipboard.writeText(text).then(()=> statusEl.textContent="ì‹œê°„í‘œë¥¼ í´ë¦½ë³´ë“œì— ë³µì‚¬í–ˆìŠµë‹ˆë‹¤."); });
  document.getElementById("startCycle").addEventListener("click", startCycle);
  document.getElementById("pause").addEventListener("click", ()=>{ if(!timer) return; if(!paused){ paused=true; remaining=endAt-Date.now(); statusEl.textContent="ì¼ì‹œì •ì§€"; } else { paused=false; endAt=Date.now()+remaining; statusEl.textContent="ì¬ê°œ"; } });
  document.getElementById("reset").addEventListener("click", ()=>{ if(timer) clearInterval(timer); timer=null; queue=[]; endAt=null; paused=false; remaining=0; phaseEl.textContent="ëŒ€ê¸°"; clockEl.textContent="00:00"; statusEl.textContent="ë¦¬ì…‹ë¨"; });
  document.getElementById("notifSwitch").addEventListener("click", ()=>{ notifChk.checked=!notifChk.checked; if(notifChk.checked && "Notification" in window) Notification.requestPermission(); });
  document.getElementById("beepSwitch").addEventListener("click", ()=>{ beepChk.checked=!beepChk.checked; if(beepChk.checked) beep(); });
  if('serviceWorker' in navigator){ navigator.serviceWorker.register('./sw.js').catch(()=>{}); }
});
</script>
</body>
</html>
